<mat-card>
  <mat-card-header>
    <mat-card-title>{{vm.title}}</mat-card-title>
    <mat-card-subtitle>
      <a [innerText]="'r/'+vm.subreddit" [routerLink]="['/r', vm.subreddit]"></a>
      <span style="margin-left: .5em;">{{vm.createdOn | date:'short'}}</span>
    </mat-card-subtitle>
  </mat-card-header>

  <a *ngIf="vm.hasImage" [href]="vm.url" target="_blank" rel="noopener noreferrer">
    <img #imgPost mat-card-image [src]="vm.thumbnail" loading="lazy">
  </a>

  <video #vdoPost *ngIf="vm.hasVideo" mat-card-image controls="" muted="" [poster]="vm.thumbnail" preload="none"
    (loadedmetadata)="vdoPost.muted=true">
    <source *ngFor="let videoSrc of vm.videoSrcs" [src]="videoSrc">
  </video>

  <div *ngIf="vm.hasEmbed" mat-card-image [innerHTML]="vm.embed"></div>

  <mat-card-content *ngIf="!vm.stickied && vm.hasText">
    <p #textPost style="overflow: hidden; max-height: 60vh;"
      [class.masked]="textPost.scrollHeight > textPost.clientHeight" [innerHTML]="vm.text"
      (click)="textPost.style.maxHeight = 'none'"></p>
  </mat-card-content>

  <mat-card-content *ngIf="vm.hasLink">
    <p style="overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">
      <a [href]="vm.url" [innerText]="vm.url" target="_blank" rel="noopener noreferrer"></a>
    </p>
  </mat-card-content>

  <mat-card-actions>
    <button mat-icon-button aria-label="Share" *ngIf="canShare">
      <mat-icon *ngIf="!isSharing && !canShareImage" (click)="share()">share</mat-icon>
      <mat-spinner diameter="35" *ngIf="isSharing"></mat-spinner>
      <mat-icon *ngIf="canShareImage" (click)="shareImage()">photo_camera</mat-icon>
    </button>
  </mat-card-actions>
</mat-card>
